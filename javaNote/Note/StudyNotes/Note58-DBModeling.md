# DB 모델링
시스템을 분석하고 구조화시켜 글과 그림으로 표현(추상화)한 것.

> 중복 데이터를 제거함으로써 데이터의 안전성, 신뢰성, 즉 결함이 없는 상태로 만드는 것이 목적이다. => 일관성, 무결성

## 논리 모델링
특정 DBMS를 고려하지 않고 수행하는 개념적인 모델링

### 1. 엔티티 식별 및 속성 식별
- 특정 값의 집합, 시스템에서 다루는 데이터를 정의한다. 
- 예를 들면 집합은 테이블이고 다룰 데이터는 속성(attribute)로서 식별하여 만든다.

### 2. 주 키 선정
- 데이터를 구분할 식별자를 지정한다. PK로 지정할 적절한 컬럼이 없거나, 여러개의 컬럼을 묶어서 사용해야 하는 경우 surrogate key를 주로 사용한다. 

### 3. 정규화
데이터 중복을 찾아내어 별도의 테이블로 분리시키는 것

> 함수 종속성?
- 어떤 속성 A의 값을 알면 다른 속성 B의 값이 유일하게 정해지는 관계를 종속성이라 한다. 
- A -> B로 표기하며 A를 B의 결정자라고 한다. 

**1. 제1정규화**
- 중복 데이터 또는 중복 컬럼을 별도의 테이블로 분리하여 부모-자식 관계를 맺는다. 
- 자식 테이블에서는 부모 테이블의 데이터를 가리키기 위해 그 데이터의 pk값을 보관해야 한다. 
- 즉, 중복 데이터를 분리 시켜 각각의 원자값으로 만들고 1 : 다 관계로 만드는 것이 제1정규화이다. 

**2. 제2정규화**
- 테이블이 제1정규형를 만족하면서 모든 속성이 기본키에 완전 함수 종속이어야 한다. 즉 부분적 종속이 없어야 한다. 완전 함수 종속은 기본키가 여러개로 묶인 복합키일 때 복합키(A,B)가 모여서 하나의 다른 값(X)을 결정하고 복합키의 부분집합이 결정자가 되면 안된다는 의미이다. 
이러한 관계는 복합키 중 하나의 키로도 다른 속성을 결정할 수 있기 때문에 다른 테이블로 분리함으로써 중복데이터를 제거할 수 있다. 

**3. 제3정규화**
- 테이블이 제2정규형을 만족하면서 이행 함수 종속을 제거하는 과정이다. 이행 함수 종속이란 속성의 종속관계가 X->Y->Z 인 관계를 의미한다. 이는 결국 X->Z를 성립하기 때문에 데이터의 무결성을 해칠 수 있다. 따라서 이를 테이블로 분리하여 데이터 중복을 제거하고 데이터 일관성을 높이는 것이다. 

### 4. 테이블 간 관계 식별
. 일반 관계

- 두 테이블 사이의 관계 식별하여 연결한다.
- 부모-자식 관계로 정의한다.
  - 데이터를 참조하는 쪽이 자식 테이블이다.
  - 데이터를 참조 당하는 쪽이 부모 테이블이다.

2. 다 대 다 관계의 해소

- 테이블과 테이블 사이에 다 대 다 관계를 형성한다면,
  일 대 다의 관계로 변경해야 한다.
- 왜? DBMS는 물리적으로 다 대 다 관계의 데이터를 저장할 수 없다.
- 해결책?
  두 테이블의 관계를 저장할 테이블을 만든다.
  "관계 테이블" 이라 부른다.
  관계 테이블은 각 테이블과 일 대 다의 관계를 맺는다.

3. 포함 관계 및 배타적 관계 식별

- 여러 테이블에 공통으로 포함되는 컬럼이 있는 경우, 별도의 테이블로 분리한다.
- 공통 데이터를 저장하고 있는 테이블 쪽(수퍼 타입 테이블)을 부모 테이블로 하고
  부모 테이블을 참조하는 테이블(서브 타입 테이블)을 자식 테이블로 하여 테이블 간에 관계를 맺는다.
  - 자식 테이블 쪽에 FK가 추가된다.
- 관계 유형
  - 포함 관계
    - 여러 테이블에서 동시에 포함할 수 있는 관계이다.
  - 배타적 관계
    - 여러 테이블 중에서 오직 한 개의 테이블만 포함할 수 있는 관계다.
  - 참고:
    - DBMS의 문법으로는 포함 관계와 배타적 관계를 구분할 수 없다
    - 즉 포함관계와 배타적관계를 제어할 수 있는 SQL 문법은 없다.
    - 프로그래밍으로 제어해야 한다.

4. 관계의 차수 지정 p.321 ~ 324, 329

- 데이터 끼리 상호 관계의 개수를 지정한다.
- 예)
  1 : _ (0이상) => FK 컬럼이 not null 이다.
  1 : 1.._ (1이상) => FK 컬럼이 not null 이다.
  0,1 : _ (0이상) => FK 컬럼이 null 허용이다.
  0,1 : 1.._ (1이상) => FK 컬럼이 null 허용이다.